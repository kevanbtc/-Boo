<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>$BOO ‚Äî The Spookiest Meme Token on Polygon</title>
  <meta name="description" content="0.5% fees, 20% burned, tiered affiliates up to 3%, staking rewards, and NFT utilities. Join the Halloween revolution on Polygon." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0b0b0f;
      --panel:#12121a;
      --accent:#ff6a00;
      --accent-2:#ffa94d;
      --ink:#e8e8ec;
      --muted:#9aa0aa;
      --green:#22d3ee;
      --violet:#8b5cf6;
      --red:#ef4444;
      --glow: 0 0 24px #ff6a00aa, 0 0 48px #ff6a0055;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 500px at 50% -10%, #1a1320 0%, transparent 60%) , var(--bg);
      color:var(--ink); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      overflow-x:hidden;
    }
    /* Enhanced Halloween Theme */
    :root{
      --bg: #0b0b0f;
      --panel:#12121a;
      --accent:#ff6a00;
      --accent-2:#ffa94d;
      --ink:#e8e8ec;
      --muted:#9aa0aa;
      --green:#22d3ee;
      --violet:#8b5cf6;
      --red:#ef4444;
      --glow: 0 0 24px #ff6a00aa, 0 0 48px #ff6a0055;
      --pumpkin: #ff8c00;
      --ghost: #f8f8ff;
      --blood: #8b0000;
    }

    /* Enhanced fog with more layers */
    .fog, .fog::before, .fog::after, .fog::nth-child(2), .fog::nth-child(3){
      position:fixed; inset:-10% -10% auto -10%; height:60vh; pointer-events:none; z-index:0;
      background: radial-gradient(800px 200px at 20% 0%, #ffffff0a, transparent 60%),
                  radial-gradient(600px 160px at 80% 10%, #ffffff08, transparent 60%);
      filter: blur(24px); mix-blend-mode: screen; animation: fogMove 40s linear infinite;
    }
    .fog::before{content:""; animation-duration: 60s; opacity:.7}
    .fog::after{content:""; animation-duration: 90s; opacity:.5}
    .fog:nth-child(2){animation-duration: 120s; opacity:.3; height:40vh; top:20%}
    .fog:nth-child(3){animation-duration: 80s; opacity:.4; height:50vh; top:10%}

    /* Enhanced bats with more variety */
    #bats{position:fixed; inset:0; z-index:1; pointer-events:none; opacity:.8}

    /* Floating pumpkins and ghosts */
    .floating-elements{position:fixed; inset:0; z-index:2; pointer-events:none}
    .pumpkin, .ghost, .spider{
      position:absolute; animation: float 6s ease-in-out infinite;
      filter: drop-shadow(0 0 10px currentColor);
    }
    .pumpkin{color:var(--pumpkin); font-size:2rem; animation-delay:-2s}
    .ghost{color:var(--ghost); font-size:1.5rem; animation-delay:-4s; opacity:.8}
    .spider{color:#333; font-size:1rem; animation-delay:-1s}
    @keyframes float{
      0%,100%{transform:translateY(0px) rotate(0deg)}
      25%{transform:translateY(-10px) rotate(2deg)}
      50%{transform:translateY(-20px) rotate(-1deg)}
      75%{transform:translateY(-10px) rotate(1deg)}
    }

    /* Interactive glow effects */
    .glow-on-hover{transition: all 0.3s ease}
    .glow-on-hover:hover{
      box-shadow: var(--glow);
      transform: translateY(-2px) scale(1.02);
      background: linear-gradient(180deg, #1a1830, #101018);
    }

    /* Pulsing elements */
    .pulse{animation: pulse 2s ease-in-out infinite}
    @keyframes pulse{
      0%,100%{opacity:1; transform:scale(1)}
      50%{opacity:.8; transform:scale(1.05)}
    }

    /* Click effects */
    .click-effect{position:relative; overflow:hidden}
    .click-effect::before{
      content:''; position:absolute; top:50%; left:50%;
      width:0; height:0; border-radius:50%;
      background:radial-gradient(circle, rgba(255,106,0,0.3) 0%, transparent 70%);
      transform:translate(-50%,-50%); transition:width 0.6s, height 0.6s;
    }
    .click-effect:active::before{width:300px; height:300px}

    /* Rainbow text effect */
    .rainbow-text{background: linear-gradient(45deg, #ff6a00, #ffa94d, #22d3ee, #8b5cf6, #ef4444); background-size:400% 400%; -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; animation: rainbow 3s ease infinite}
    @keyframes rainbow{background-position:0% 50%; background-position:400% 50%}

    /* Shimmer effect */
    .shimmer{position:relative; overflow:hidden}
    .shimmer::before{
      content:''; position:absolute; top:0; left:-100%;
      width:100%; height:100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: shimmer 2s infinite;
    }
    @keyframes shimmer{0%{left:-100%}100%{left:100%}}

    /* Ambassadors section */
    .ambassadors-grid{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:20px; margin-top:30px;
    }
    .ambassador-card{
      background:linear-gradient(135deg, #1a1830, #101018); border:1px solid #ffffff11; border-radius:15px;
      padding:20px; display:flex; align-items:center; gap:15px; transition:all 0.3s ease;
      box-shadow: 0 4px 20px rgba(255,106,0,0.1);
    }
    .ambassador-card:hover{
      transform:translateY(-5px); box-shadow: 0 8px 30px rgba(255,106,0,0.2);
      border-color:#ff6a0044;
    }
    .ambassador-avatar{
      font-size:2.5rem; width:60px; height:60px; display:flex; align-items:center; justify-content:center;
      background:radial-gradient(circle, rgba(255,106,0,0.2), rgba(255,106,0,0.05)); border-radius:50%;
      border:2px solid #ff6a0022;
    }
    .ambassador-info{flex:1}
    .ambassador-name{font-weight:700; font-size:1.1rem; color:#ffd700; margin-bottom:5px}
    .ambassador-tier{font-size:0.9rem; color:#ff6a00; margin-bottom:3px}
    .ambassador-volume{font-size:0.85rem; color:#9aa0aa}

    /* Enhanced buttons */
    .btn:hover{animation: wiggle 0.5s ease}
    @keyframes wiggle{0%,100%{transform:translateX(0)}25%{transform:translateX(-2px)}75%{transform:translateX(2px)}}

    /* Magic cursor */
    *{cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='%23ff6a00' d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'/%3E%3C/svg%3E"), auto;}

    /* Interactive stats */
    .stat-card:hover .metric{animation: countUp 0.5s ease}
    @keyframes countUp{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}

    /* Sound effects (visual feedback) */
    .sound-wave{position:absolute; opacity:0; pointer-events:none; animation: soundWave 1s ease-out}
    @keyframes soundWave{0%{opacity:1; transform:scale(0)}100%{opacity:0; transform:scale(2)}}
  </style>
</head>
<body>
  <!-- Enhanced fog layers -->
  <div class="fog"></div>
  <div class="fog"></div>
  <div class="fog"></div>

  <!-- Floating Halloween elements -->
  <div class="floating-elements">
    <div class="pumpkin" style="top:20%; left:10%">üéÉ</div>
    <div class="ghost" style="top:40%; right:15%">üëª</div>
    <div class="pumpkin" style="top:60%; left:20%">üéÉ</div>
    <div class="ghost" style="top:70%; right:25%">üëª</div>
    <div class="spider" style="top:30%; left:80%">üï∑Ô∏è</div>
    <div class="pumpkin" style="top:80%; left:70%">üéÉ</div>
  </div>

  <!-- Enhanced bats -->
  <canvas id="bats" width="1920" height="1080" aria-hidden="true"></canvas>

  <!-- Spooky random messages -->
  <div class="spooky-messages" id="spookyMessages"></div>

    /* Nav */
    .nav{
      position:sticky; top:0; z-index:5; backdrop-filter: blur(8px);
      background: linear-gradient(180deg, #0b0b0fcc 20%, #0b0b0f00 100%);
      border-bottom:1px solid #ffffff12;
    }
    .wrap{max-width:1200px; margin:0 auto; padding:0 16px}
    .row{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:16px 0}
    .brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--ink)}
    .badge{font-size:12px; padding:4px 8px; border:1px solid #ffffff22; border-radius:999px; color:#c6c6d4}
    .menu{display:flex; gap:16px; flex-wrap:wrap}
    .menu a{color:#c6c6d4; text-decoration:none; font-size:14px; padding:8px 10px; border-radius:10px}
    .menu a:hover{background:#ffffff10; color:var(--ink)}
    .btn{background:var(--accent); color:#0b0b0f; border:none; border-radius:12px; padding:10px 14px; font-weight:700; cursor:pointer}
    .btn.secondary{background:#ffffff10; color:var(--ink); border:1px solid #ffffff14}
    .btn:active{transform:translateY(1px)}

    /* Hero */
    .hero{position:relative; z-index:2; padding:72px 0 40px}
    h1{
      font-size: clamp(36px, 6vw, 64px);
      line-height:1.02; margin:0 0 12px;
      font-weight:900; letter-spacing:-0.02em;
      text-shadow: 0 0 20px #ff6a0011;
    }
    .neon{color:var(--accent); text-shadow: var(--glow);}
    .sub{color:#cfcfe8; max-width:800px}
    .stats{display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:12px; margin-top:28px}
    .card{
      background: linear-gradient(180deg, #171722, #0f0f15);
      border:1px solid #ffffff12; border-radius:16px; padding:16px;
    }
    .metric{font-size:28px; font-weight:900}
    .label{font-size:12px; color:var(--muted)}
    .cta{display:flex; gap:12px; margin-top:24px; flex-wrap:wrap}
    .cta a, .cta button {text-decoration:none}

    /* Sections */
    section{position:relative; z-index:2; padding:48px 0}
    h2{font-size: clamp(24px, 4vw, 36px); margin:0 0 10px}
    p{color:#cfd2da}

    .grid-feat{display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:16px}
    .panel{background:linear-gradient(180deg,#151521,#0f0f15); border:1px solid #ffffff12; border-radius:16px; padding:18px}
    .panel h3{margin:0 0 6px}
    .muted{color:var(--muted)}

    .grid-sections{display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:16px}
    .tile{display:block; text-decoration:none; color:inherit}
    .tile .panel{transition:transform .12s ease, background .2s ease}
    .tile:hover .panel{transform: translateY(-2px); background:linear-gradient(180deg,#1a1830,#101018)}

    /* Transparency */
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size:12px; word-break:break-all}

    /* Footer */
    footer{border-top:1px solid #ffffff12; padding:32px 0 60px; color:#9aa0aa}

    /* Countdown */
    .countdown{display:flex; gap:12px; margin-top:16px}
    .tick{background:#ffffff08; border:1px solid #ffffff12; border-radius:12px; padding:10px 12px; text-align:center; min-width:70px}
    .tick b{display:block; font-size:20px}
    .tick span{font-size:11px; color:#9aa0aa}

    /* Scroll reveal */
    .reveal{opacity:0; transform: translateY(12px); transition: opacity .5s ease, transform .5s ease}
    .reveal.show{opacity:1; transform:none}

    /* Mobile */
    @media (max-width: 960px){
      .menu{display:none}
      .stats{grid-template-columns:repeat(2,1fr)}
      .grid-feat{grid-template-columns:1fr}
      .grid-sections{grid-template-columns:1fr 1fr}
    }
    @media (max-width: 640px){
      .grid-sections{grid-template-columns:1fr}
    }

    /* Logo wordmark */
    .word{
      font-family: "UnifrakturMaguntia", serif;
      letter-spacing: .5px;
    }
    .polytag{
      font-size:12px; padding:4px 8px; border:1px solid #9b59b680; color:#d6b3ff;
      border-radius:999px; background:#8b5cf61220;
    }

    /* Toast */
    .toast{position:fixed; right:18px; bottom:18px; background:#111827; color:#e5e7eb; border:1px solid #ffffff1a; border-radius:12px; padding:10px 14px; z-index:999; display:none}
    .toast.show{display:block; animation: fadeToast 2.2s ease forwards}
    @keyframes fadeToast{0%{opacity:0; transform: translateY(6px)}10%{opacity:1; transform:none}85%{opacity:1}100%{opacity:0}}
  </style>
</head>
<body>
  <!-- fog + bats -->
  <div class="fog"></div>
  <canvas id="bats" width="1920" height="1080" aria-hidden="true"></canvas>

  <!-- NAV -->
  <div class="nav">
    <div class="wrap">
      <div class="row">
        <a class="brand" href="#">
          <span style="font-size:20px">ü¶á</span>
          <strong class="word rainbow-text" style="font-size:22px">$BOO</strong>
          <span class="polytag">Polygon</span>
        </a>
        <nav class="menu">
          <a href="#early">Early Access</a>
          <a href="#certificate">Certificate</a>
          <a href="#ambassadors">Ambassadors</a>
          <a href="#refer">Refer & Earn</a>
          <a href="#quests">Quests</a>
          <a href="#stake">Stake</a>
          <a href="#airdrop">Airdrop</a>
          <a href="#leaderboard">Leaderboard</a>
          <a href="#transparency">Transparency</a>
        </nav>
        <div style="display:flex; gap:8px">
          <button class="btn secondary" id="docsBtn">Docs</button>
          <button class="btn" id="connectBtn">Connect Wallet</button>
        </div>
      </div>
    </div>
  </div>

  <!-- HERO -->
  <header class="wrap hero">
    <h1 class="reveal">The <span class="neon">spookiest</span> meme token on Polygon</h1>
    <p class="sub reveal">0.5% fees, <b>20% burned</b>, tiered affiliates up to <b>3%</b>, staking rewards, and NFT utilities. Join the Halloween revolution! üéÉ</p>

    <!-- Countdown to Halloween 2025 -->
    <div class="countdown reveal" id="countdown">
      <div class="tick"><b id="d">‚Äî</b><span>Days</span></div>
      <div class="tick"><b id="h">‚Äî</b><span>Hours</span></div>
      <div class="tick"><b id="m">‚Äî</b><span>Minutes</span></div>
      <div class="tick"><b id="s">‚Äî</b><span>Seconds</span></div>
    </div>

    <div class="cta reveal">
      <a class="btn" href="#early">Early Access</a>
      <a class="btn secondary" href="#refer">Refer & Earn</a>
      <a class="btn secondary" href="#stake">Stake</a>
    </div>

    <div class="stats reveal">
      <div class="card">
        <div class="metric pulse">1B</div>
        <div class="label">Total Supply</div>
      </div>
      <div class="card">
        <div class="metric pulse">20%</div>
        <div class="label">Burn Rate</div>
      </div>
      <div class="card">
        <div class="metric pulse">0.5%</div>
        <div class="label">Trading Fee</div>
      </div>
      <div class="card">
        <div class="metric pulse">3%</div>
        <div class="label">Max Affiliate</div>
      </div>
    </div>
  </header>

  <!-- WHY -->
  <section class="wrap">
    <h2 class="reveal">Why $BOO?</h2>
    <div class="grid-feat">
      <div class="panel reveal">
        <h3>üî• Deflationary Burns</h3>
        <p>20% of every trade is burned forever, increasing scarcity and value.</p>
      </div>
      <div class="panel reveal">
        <h3>üëª Affiliate Program</h3>
        <p>Earn 1.5‚Äì3% commissions based on your referral volume. Higher tiers for bigger contributors.</p>
      </div>
      <div class="panel reveal">
        <h3>üéÅ Staking Rewards</h3>
        <p>Lock $BOO for 7‚Äì31 days to earn APR up to 25%, with Halloween NFT boosts.</p>
      </div>
    </div>
    <p style="margin-top:18px; text-align:center; color:#cfd2da">üéÉ Beware the BOO! The Halloween spirit lives on Polygon. üéÉ</p>
  </section>

  <!-- ACTION GRID -->
  <section class="wrap">
    <div class="grid-sections">
      <a class="tile" id="early" href="/early">
        <div class="panel reveal">
          <h3>Early Access</h3>
          <p class="muted">Friends & Family: <b>Sep 22, 2025</b> ‚Ä¢ Presale: <b>Oct 5, 2025</b> ‚Ä¢ Launch: <b>Oct 31, 2025</b></p>
          <p class="muted" style="font-size:0.9rem; margin-top:8px">Onramp via card/crypto and claim your personal link.</p>
          <div style="margin-top:10px"><span class="btn shimmer" style="padding:8px 12px">Start Now</span></div>
        </div>
      </a>
      <a class="tile" id="refer" href="/refer">
        <div class="panel reveal">
          <h3>Refer & Earn</h3>
          <p class="muted">Tiered affiliates up to 3% with rolling 30-day volume tiers.</p>
          <div style="margin-top:10px"><span class="btn" style="padding:8px 12px">Get Link</span></div>
        </div>
      </a>
      <a class="tile" id="quests" href="/quests">
        <div class="panel reveal">
          <h3>Quests</h3>
          <p class="muted">Complete seasonal quests to earn points and redeem Halloween NFTs.</p>
          <div style="margin-top:10px"><span class="btn" style="padding:8px 12px">Play</span></div>
        </div>
      </a>
      <a class="tile" id="stake" href="/stake">
        <div class="panel reveal">
          <h3>Stake</h3>
          <p class="muted">Lock BOO for 7/14/31 days and boost with Costume NFTs.</p>
          <div style="margin-top:10px"><span class="btn" style="padding:8px 12px">Stake Now</span></div>
        </div>
      </a>
      <a class="tile" id="airdrop" href="/airdrop">
        <div class="panel reveal">
          <h3>Airdrop</h3>
          <p class="muted">Merkle claims for early community and affiliates.</p>
          <div style="margin-top:10px"><span class="btn" style="padding:8px 12px">Claim</span></div>
        </div>
      </a>
      <a class="tile" id="leaderboard" href="/leaderboard">
        <div class="panel reveal">
          <h3>Leaderboard</h3>
          <p class="muted">Top referrers and stakers win weekly prize drops.</p>
          <div style="margin-top:10px"><span class="btn" style="padding:8px 12px">View</span></div>
        </div>
      </a>
    </div>
  </section>

  <!-- EARLY ACCESS PURCHASE SECTION -->
  <section class="wrap" id="early-access-buy">
    <h2 class="reveal">üéÉ Early Access Purchase</h2>
    <div class="panel reveal">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
        <div>
          <h3 style="color: var(--accent); margin-bottom: 1rem;">Live Contract Status</h3>
          <p><strong>Total Supply:</strong> <span id="totalSupply">Loading...</span></p>
          <p><strong>Total Burned:</strong> <span id="totalBurned">Loading...</span></p>
          <p><strong>Fees Collected:</strong> <span id="totalFees">Loading...</span></p>
          <p><strong>Contract Status:</strong> <span id="contractStatus">Loading...</span></p>
        </div>
        <div>
          <h3 style="color: var(--accent); margin-bottom: 1rem;">Purchase Details</h3>
          <p><strong>Phase:</strong> Friends & Family (Sep 22, 2025)</p>
          <p><strong>Min Purchase:</strong> 100 BOO</p>
          <p><strong>Max Purchase:</strong> 10,000 BOO (Launch Guard)</p>
          <p><strong>Network:</strong> Polygon Mainnet</p>
          <p><strong>Token Address:</strong> <span class="mono" style="font-size: 0.8rem;">0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD</span></p>
        </div>
      </div>

      <div style="text-align: center; margin-bottom: 2rem;">
        <button id="connectWalletBtn" class="btn" style="font-size: 1.1rem; padding: 1rem 2rem; margin-right: 1rem;">
          üîó Connect Wallet
        </button>
        <div style="display: inline-block; margin-left: 1rem;">
          <input id="buyAmount" type="number" placeholder="100" min="100" max="10000" step="100"
                 style="padding: 1rem; border-radius: 10px; border: 1px solid #ffffff22; background: #0f1220; color: var(--ink); width: 120px; text-align: center;">
          <span style="margin-left: 0.5rem; color: var(--muted);">BOO</span>
        </div>
      </div>

      <!-- SWAP MODULE -->
      <div id="swapContainer" style="text-align: center;">
        <!-- QuickSwap Deep Link (Primary CTA) -->
        <a class="btn shimmer"
           style="font-size: 1.3rem; padding: 1.2rem 3rem; margin-bottom: 1rem; display: inline-block;"
           target="_blank"
           href="https://quickswap.exchange/#/swap?currency0=0x3c499c542cEF5E3811e1192ce70d8cC03d5c3359&currency1=0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD">
          üéÉ Buy $BOO on QuickSwap
        </a>

        <!-- Advanced Swap (Embedded) -->
        <div id="advancedSwap" style="margin-top: 1.5rem; padding: 1rem; background: var(--panel); border-radius: 12px; max-width: 400px; margin-left: auto; margin-right: auto;">
          <h4 style="margin-bottom: 1rem; color: var(--accent);">üî• Advanced Swap</h4>
          <div style="display: flex; gap: 8px; margin-bottom: 1rem;">
            <input id="swapAmount" type="number" min="25" step="1" placeholder="Amount in USDC"
                   style="flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #ffffff22; background: #111827; color: #e5e7eb;">
            <button id="swapBtn" class="btn secondary">Swap</button>
          </div>
          <div id="swapMsg" style="font-size: 0.85rem; color: var(--muted); min-height: 20px;"></div>
        </div>

        <p style="margin-top: 1rem; color: var(--muted); font-size: 0.9rem;">
          Contract live & verified ‚Ä¢ Choose your preferred swap method
        </p>
      </div>
    </div>
  </section>

  <!-- REFERRAL DASHBOARD -->
  <section class="wrap" id="refer">
    <h2 class="reveal">üîó Referral Dashboard</h2>

    <!-- Connect Wallet Section -->
    <div class="panel reveal">
      <div style="text-align: center; margin-bottom: 1.5rem;">
        <button id="refConnectBtn" class="btn" style="font-size: 1.1rem; padding: 0.8rem 2rem;">
          Connect Wallet to Load Stats
        </button>
      </div>

      <!-- Stats Dashboard (Hidden until connected) -->
      <div id="refStatsContainer" style="display: none;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
          <div style="background: var(--panel); padding: 1rem; border-radius: 8px; text-align: center;">
            <h4 style="color: var(--green); margin-bottom: 0.5rem;">30-Day Volume</h4>
            <div id="refVolume" style="font-size: 1.5rem; font-weight: bold;">‚Äî</div>
            <div style="font-size: 0.8rem; color: var(--muted);">BOO referred</div>
          </div>
          <div style="background: var(--panel); padding: 1rem; border-radius: 8px; text-align: center;">
            <h4 style="color: var(--accent); margin-bottom: 0.5rem;">Current Tier</h4>
            <div id="refTier" style="font-size: 1.5rem; font-weight: bold;">‚Äî</div>
            <div id="refBps" style="font-size: 0.8rem; color: var(--muted);">‚Äî commission</div>
          </div>
          <div style="background: var(--panel); padding: 1rem; border-radius: 8px; text-align: center;">
            <h4 style="color: var(--violet); margin-bottom: 0.5rem;">Next Tier</h4>
            <div id="refNextTarget" style="font-size: 1.5rem; font-weight: bold;">‚Äî</div>
            <div style="font-size: 0.8rem; color: var(--muted);">BOO needed</div>
          </div>
        </div>

        <!-- Link Generation & Sharing -->
        <div style="background: #0f1419; padding: 1.5rem; border-radius: 10px; border: 1px solid var(--accent);">
          <h4 style="margin-bottom: 1rem; color: var(--accent);">üì® Your Referral Tools</h4>
          <div style="display: flex; gap: 8px; margin-bottom: 1rem; flex-wrap: wrap;">
            <button id="copyLinkBtn" class="btn" style="flex: 1; min-width: 150px;">Copy My Link</button>
            <button id="qrCodeBtn" class="btn secondary" style="flex: 1; min-width: 150px;">Generate QR</button>
            <button id="tweetBtn" class="btn secondary" style="flex: 1; min-width: 150px;">Tweet It</button>
          </div>
          <div id="refLink" style="font-family: monospace; font-size: 0.85rem; color: var(--muted); word-break: break-all; background: #1a1a1a; padding: 8px; border-radius: 6px;">
            Connect wallet to generate your link...
          </div>
        </div>
      </div>
    </div>

    <!-- Tier Explanation -->
    <div class="panel reveal" style="margin-top: 1.5rem;">
      <h3 style="color: var(--accent); margin-bottom: 1rem;">üèÜ Referral Tiers</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div style="background: #1a1a1a; padding: 1rem; border-radius: 8px; text-align: center;">
          <h4 style="color: var(--muted);">Base Tier</h4>
          <div style="font-size: 1.2rem; font-weight: bold; color: var(--green);">1.5%</div>
          <div style="font-size: 0.8rem; color: var(--muted);">0 - 999 BOO</div>
        </div>
        <div style="background: #1a1a1a; padding: 1rem; border-radius: 8px; text-align: center;">
          <h4 style="color: #fbbf24;">Tier 3</h4>
          <div style="font-size: 1.2rem; font-weight: bold; color: var(--green);">2.0%</div>
          <div style="font-size: 0.8rem; color: var(--muted);">1,000+ BOO</div>
        </div>
        <div style="background: #1a1a1a; padding: 1rem; border-radius: 8px; text-align: center;">
          <h4 style="color: #8b5cf6;">Tier 2</h4>
          <div style="font-size: 1.2rem; font-weight: bold; color: var(--green);">2.5%</div>
          <div style="font-size: 0.8rem; color: var(--muted);">25,000+ BOO</div>
        </div>
        <div style="background: #1a1a1a; padding: 1rem; border-radius: 8px; text-align: center;">
          <h4 style="color: #ef4444;">Tier 1</h4>
          <div style="font-size: 1.2rem; font-weight: bold; color: var(--green);">3.0%</div>
          <div style="font-size: 0.8rem; color: var(--muted);">100,000+ BOO</div>
        </div>
      </div>
    </div>
  </section>

  <!-- AMBASSADORS -->
  <section class="wrap" id="ambassadors">
    <h2 class="reveal">üéÉ Top 50 Ambassadors üéÉ</h2>
    <p class="reveal" style="text-align:center; margin-bottom:30px; color:#ffd700">Our elite affiliate partners driving the BOO revolution</p>

    <div class="ambassadors-grid reveal" id="ambassadorsGrid">
      <!-- Ambassadors will be loaded dynamically -->
    </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëë</div>
        <div class="ambassador-info">
          <div class="ambassador-name">CryptoKing</div>
          <div class="ambassador-tier">Tier 1 - 3% Commission</div>
          <div class="ambassador-volume">Volume: 500K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">HalloweenHODL</div>
          <div class="ambassador-tier">Tier 1 - 3% Commission</div>
          <div class="ambassador-volume">Volume: 450K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">PumpkinLord</div>
          <div class="ambassador-tier">Tier 1 - 3% Commission</div>
          <div class="ambassador-volume">Volume: 420K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">GhostTrader</div>
          <div class="ambassador-tier">Tier 1 - 3% Commission</div>
          <div class="ambassador-volume">Volume: 380K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∑Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">SpiderWeb</div>
          <div class="ambassador-tier">Tier 1 - 3% Commission</div>
          <div class="ambassador-volume">Volume: 350K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">SkullCrusher</div>
          <div class="ambassador-tier">Tier 1 - 3% Commission</div>
          <div class="ambassador-volume">Volume: 320K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">WitchWallet</div>
          <div class="ambassador-tier">Tier 2 - 2.5% Commission</div>
          <div class="ambassador-volume">Volume: 280K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">BatSignal</div>
          <div class="ambassador-tier">Tier 2 - 2.5% Commission</div>
          <div class="ambassador-volume">Volume: 250K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">JackOLantern</div>
          <div class="ambassador-tier">Tier 2 - 2.5% Commission</div>
          <div class="ambassador-volume">Volume: 220K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">PhantomForce</div>
          <div class="ambassador-tier">Tier 2 - 2.5% Commission</div>
          <div class="ambassador-volume">Volume: 200K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∏Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">WebMaster</div>
          <div class="ambassador-tier">Tier 2 - 2.5% Commission</div>
          <div class="ambassador-volume">Volume: 180K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">BoneChiller</div>
          <div class="ambassador-tier">Tier 2 - 2.5% Commission</div>
          <div class="ambassador-volume">Volume: 160K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">SpellCaster</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 140K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">NightWing</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 120K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">HarvestMoon</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 100K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">SpiritWalker</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 90K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∑Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Arachnid</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 80K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">DeathDealer</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 70K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Enchantress</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 60K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">VampireBat</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 50K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">LanternLight</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 45K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Poltergeist</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 40K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∑Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">BlackWidow</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 35K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">GrimReaper</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 30K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Sorceress</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 25K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">EchoBat</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 20K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">AutumnGlow</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 18K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Wraith</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 16K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∑Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">SilkSpinner</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 14K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">SoulReaper</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 12K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">MysticMage</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 10K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">ShadowBat</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 9K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">CandleLight</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 8K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Phantom</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 7K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∑Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-avatar">WebWeaver</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 6K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">BoneCollector</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 5K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">CrystalBall</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 4K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">ü¶á</div>
        <div class="ambassador-info">
          <div class="ambassador-name">NightHunter</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 3K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üéÉ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">OrangeGlow</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 2K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üëª</div>
        <div class="ambassador-info">
          <div class="ambassador-name">Ethereal</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 1K $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üï∑Ô∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">VenomFang</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 500 $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üíÄ</div>
        <div class="ambassador-info">
          <div class="ambassador-name">DarkLord</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 250 $BOO</div>
        </div>
      </div>
      <div class="ambassador-card">
        <div class="ambassador-avatar">üßô‚Äç‚ôÄÔ∏è</div>
        <div class="ambassador-info">
          <div class="ambassador-name">ArcaneArts</div>
          <div class="ambassador-tier">Tier 3 - 2% Commission</div>
          <div class="ambassador-volume">Volume: 100 $BOO</div>
        </div>
      </div>
    </div>

    <div class="panel reveal" style="margin-top:40px; text-align:center">
      <h3>üéÉ Become an Ambassador Today! üéÉ</h3>
      <p class="muted">Join our elite affiliate program and earn up to 3% commission on all referrals. Higher tiers unlock with more volume!</p>
      <div style="margin-top:20px">
        <a href="#refer" class="btn glow-on-hover">Join Ambassador Program</a>
      </div>
    </div>
  </section>

  <!-- TRANSPARENCY -->
  <section class="wrap" id="transparency">
    <h2 class="reveal">Transparency</h2>
    <div class="grid-feat">
      <div class="panel reveal">
        <h3>Token</h3>
        <div class="mono" id="tokenAddr">0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD</div>
        <a href="https://polygonscan.com/address/0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD" target="_blank" rel="noopener noreferrer" class="muted">View on Polygonscan ‚Üó</a>
      </div>
      <div class="panel reveal">
        <h3>Referral Registry</h3>
        <div class="mono" id="refAddr">0xbeeE2b44Fa90F2E0A1c9240Fd5483292b2c52fbe</div>
        <a href="https://polygonscan.com/address/0xbeeE2b44Fa90F2E0A1c9240Fd5483292b2c52fbe" target="_blank" rel="noopener noreferrer" class="muted">View on Polygonscan ‚Üó</a>
      </div>
      <div class="panel reveal">
        <h3>Fee Router</h3>
        <div class="mono">0x992f1e349741b5fA61fc7B0c901ee6e5959793Ca</div>
        <a href="https://polygonscan.com/address/0x992f1e349741b5fA61fc7B0c901ee6e5959793Ca" target="_blank" rel="noopener noreferrer" class="muted">View on Polygonscan ‚Üó</a>
      </div>
      <div class="panel reveal">
        <h3>Staking Manager</h3>
        <div class="mono">0xee10AB608748F886497cD37E46D506FAf5CC11D1</div>
        <a href="https://polygonscan.com/address/0xee10AB608748F886497cD37E46D506FAf5CC11D1" target="_blank" rel="noopener noreferrer" class="muted">View on Polygonscan ‚Üó</a>
      </div>
      <div class="panel reveal">
        <h3>Boo Costume NFT</h3>
        <div class="mono">0x1F5a80e75A0764440dC9F0c5Dd6AE9f63c64EE3c</div>
        <a href="https://polygonscan.com/address/0x1F5a80e75A0764440dC9F0c5Dd6AE9f63c64EE3c" target="_blank" rel="noopener noreferrer" class="muted">View on Polygonscan ‚Üó</a>
      </div>
      <div class="panel reveal">
        <h3>Airdrop Merkle</h3>
        <div class="mono">0x671A04aE4a2D1C6b7ef0f512E3d0C84EEDA7858C</div>
        <a href="https://polygonscan.com/address/0x671A04aE4a2D1C6b7ef0f512E3d0C84EEDA7858C" target="_blank" rel="noopener noreferrer" class="muted">View on Polygonscan ‚Üó</a>
      </div>
      <div class="panel reveal">
        <h3>Fee Split</h3>
        <p class="muted">0.5% total: <b>40%</b> LP / <b>20%</b> Prize / <b>20%</b> Affiliate / <b>20%</b> Burn. Early-unstake penalty burn: <b>5%</b>.</p>
        <p class="muted">Code: <a href="https://github.com/kevanbtc/-Boo" target="_blank" rel="noopener noreferrer">github.com/kevanbtc/-Boo</a></p>
      </div>
    </div>
  </section>

  <!-- CERTIFICATE -->
  <section class="wrap" id="certificate">
    <h2 class="reveal">üìú Official Deployment Certificate</h2>
    <div class="panel reveal" style="text-align: left; max-width: 100%;">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
        <div>
          <h3 style="color: var(--accent); margin-bottom: 1rem;">üìã Certificate Details</h3>
          <p><strong>Certificate ID:</strong> BOO-DEPLOY-2025-09-22</p>
          <p><strong>Issue Date:</strong> September 22, 2025</p>
          <p><strong>Network:</strong> Polygon PoS Mainnet (Chain ID: 137)</p>
          <p><strong>Developer:</strong> kevanbtc</p>
          <p><strong>Status:</strong> <span style="color: var(--green);">‚úÖ LIVE & VERIFIED</span></p>
        </div>
        <div>
          <h3 style="color: var(--accent); margin-bottom: 1rem;">üí∞ Token Economics</h3>
          <p><strong>Token:</strong> $BOO (Boo)</p>
          <p><strong>Supply:</strong> 1,000,000,000 BOO</p>
          <p><strong>Launch:</strong> October 31, 2025</p>
          <p><strong>Fees:</strong> 0.5% (20% burned)</p>
          <p><strong>Deployment Cost:</strong> 0.39 POL</p>
        </div>
      </div>

      <h3 style="color: var(--accent); margin-bottom: 1rem;">üîó Live Contract Addresses</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
        <div class="panel" style="background: var(--panel); padding: 1rem;">
          <h4>$BOO Token</h4>
          <div class="mono" style="font-size: 0.9rem; word-break: break-all;">0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD</div>
          <a href="https://polygonscan.com/address/0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD" target="_blank" rel="noopener noreferrer" class="btn" style="margin-top: 0.5rem;">View on PolygonScan ‚Üó</a>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem;">
          <h4>Referral Registry</h4>
          <div class="mono" style="font-size: 0.9rem; word-break: break-all;">0xbeeE2b44Fa90F2E0A1c9240Fd5483292b2c52fbe</div>
          <a href="https://polygonscan.com/address/0xbeeE2b44Fa90F2E0A1c9240Fd5483292b2c52fbe" target="_blank" rel="noopener noreferrer" class="btn" style="margin-top: 0.5rem;">View on PolygonScan ‚Üó</a>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem;">
          <h4>Fee Router</h4>
          <div class="mono" style="font-size: 0.9rem; word-break: break-all;">0x992f1e349741b5fA61fc7B0c901ee6e5959793Ca</div>
          <a href="https://polygonscan.com/address/0x992f1e349741b5fA61fc7B0c901ee6e5959793Ca" target="_blank" rel="noopener noreferrer" class="btn" style="margin-top: 0.5rem;">View on PolygonScan ‚Üó</a>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem;">
          <h4>Staking Manager</h4>
          <div class="mono" style="font-size: 0.9rem; word-break: break-all;">0xee10AB608748F886497cD37E46D506FAf5CC11D1</div>
          <a href="https://polygonscan.com/address/0xee10AB608748F886497cD37E46D506FAf5CC11D1" target="_blank" rel="noopener noreferrer" class="btn" style="margin-top: 0.5rem;">View on PolygonScan ‚Üó</a>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem;">
          <h4>Boo Costume NFT</h4>
          <div class="mono" style="font-size: 0.9rem; word-break: break-all;">0x1F5a80e75A0764440dC9F0c5Dd6AE9f63c64EE3c</div>
          <a href="https://polygonscan.com/address/0x1F5a80e75A0764440dC9F0c5Dd6AE9f63c64EE3c" target="_blank" rel="noopener noreferrer" class="btn" style="margin-top: 0.5rem;">View on PolygonScan ‚Üó</a>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem;">
          <h4>Launch Guard</h4>
          <div class="mono" style="font-size: 0.9rem; word-break: break-all;">0x4A72158B8859Fc4C9Dd0eB0C593FF07EC5327048</div>
          <a href="https://polygonscan.com/address/0x4A72158B8859Fc4C9Dd0eB0C593FF07EC5327048" target="_blank" rel="noopener noreferrer" class="btn" style="margin-top: 0.5rem;">View on PolygonScan ‚Üó</a>
        </div>
      </div>

      <h3 style="color: var(--accent); margin-bottom: 1rem;">üöÄ Launch Timeline</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
        <div class="panel" style="background: var(--panel); padding: 1rem; text-align: center;">
          <h4 style="color: var(--green);">Phase 1: Friends & Family</h4>
          <p style="font-size: 1.2rem; font-weight: bold;">September 22, 2025</p>
          <p>Private early access - TODAY!</p>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem; text-align: center;">
          <h4 style="color: var(--violet);">Phase 2: Presale</h4>
          <p style="font-size: 1.2rem; font-weight: bold;">October 5, 2025</p>
          <p>Public presale launch</p>
        </div>
        <div class="panel" style="background: var(--panel); padding: 1rem; text-align: center;">
          <h4 style="color: var(--accent);">Phase 3: Main Launch</h4>
          <p style="font-size: 1.2rem; font-weight: bold;">October 31, 2025</p>
          <p>Halloween public launch</p>
        </div>
      </div>

      <div style="text-align: center; margin-top: 2rem;">
        <a href="#early" class="btn" style="font-size: 1.2rem; padding: 1rem 2rem;">üéÉ Buy Early Access Now</a>
        <p style="margin-top: 1rem; color: var(--muted);">All contracts verified ‚Ä¢ Full transparency ‚Ä¢ Ready to launch</p>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="wrap row" style="padding-top:0">
      <div>¬© <span id="yr"></span> $BOO ‚Ä¢ Built on Polygon</div>
      <div style="display:flex; gap:12px; flex-wrap:wrap">
        <a class="muted" href="#early">Early Access</a>
        <a class="muted" href="#certificate">Certificate</a>
        <a class="muted" href="#refer">Refer</a>
        <a class="muted" href="#stake">Stake</a>
        <a class="muted" href="#airdrop">Airdrop</a>
      </div>
    </div>
  </footer>

  <!-- Toast -->
  <div class="toast" id="toast">Copied to clipboard</div>

  <script>
    // ===== Halloween Countdown (to Oct 31, 2025 23:59:59 UTC) =====
    const target = new Date('2025-11-01T00:00:00Z').getTime();
    const dEl = document.getElementById('d'), hEl = document.getElementById('h'),
          mEl = document.getElementById('m'), sEl = document.getElementById('s');
    setInterval(()=>{
      const now = Date.now(), diff = Math.max(0, target - now);
      const d = Math.floor(diff/86400000);
      const h = Math.floor((diff%86400000)/3600000);
      const m = Math.floor((diff%3600000)/60000);
      const s = Math.floor((diff%60000)/1000);
      dEl.textContent = String(d); hEl.textContent = String(h);
      mEl.textContent = String(m); sEl.textContent = String(s);

      // Add spooky effect when seconds change to 0
      if (s === 0 && diff > 0) {
        document.body.style.animation = 'shake 0.5s ease';
        setTimeout(() => document.body.style.animation = '', 500);
      }
    }, 1000);

    // ===== Scroll reveal =====
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('show'); });
    }, {threshold:.12});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // ===== Copy link generator =====
    const makeBtn = document.getElementById('makeLink');
    const copyBtn = document.getElementById('copyLink');
    const addrIn  = document.getElementById('addr');
    const out     = document.getElementById('linkOut');
    const toast   = document.getElementById('toast');
    function isAddr(x){ return /^0x[a-fA-F0-9]{40}$/.test(x); }
    function showToast(msg){
      toast.textContent = msg; toast.classList.remove('show');
      void toast.offsetWidth; toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 2200);
    }
    makeBtn.addEventListener('click', ()=>{
      const base = location.origin;
      const v = addrIn.value.trim();
      if(!isAddr(v)) { showToast('Invalid address'); return; }
      const link = `${base}/early?ref=${v}`;
      out.textContent = link;

      // Add click effect
      makeBtn.classList.add('click-effect');
      setTimeout(() => makeBtn.classList.remove('click-effect'), 600);
    });
    copyBtn.addEventListener('click', ()=>{
      const txt = out.textContent.trim();
      if(!txt) return showToast('Nothing to copy');
      navigator.clipboard.writeText(txt).then(()=>showToast('Copied to clipboard'));

      // Add click effect
      copyBtn.classList.add('click-effect');
      setTimeout(() => copyBtn.classList.remove('click-effect'), 600);
    });

    // ===== Simple fake wallet modal (placeholder) =====
    document.getElementById('connectBtn').addEventListener('click', ()=>{
      showToast('Open wallet modal (wire RainbowKit in app version)');
    });
    document.getElementById('docsBtn').addEventListener('click', ()=>{
      window.open('https://github.com/kevanbtc/-Boo', '_blank','noopener');
    });

    // ===== Enhanced Animated bats (canvas) =====
    const canvas = document.getElementById('bats'); const ctx = canvas.getContext('2d');
    function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; } resize(); addEventListener('resize', resize);
    const bats = Array.from({length: 25}).map(()=>({
      x: Math.random()*canvas.width, y: Math.random()*canvas.height*.6 + 20,
      s: Math.random()*0.6 + 0.4, vx: (Math.random()*0.6+0.4)*(Math.random()<.5?-1:1), t: Math.random()*Math.PI*2,
      opacity: Math.random() * 0.5 + 0.3
    }));
    function drawBat(x,y,scale,flap,opacity){
      ctx.save(); ctx.translate(x,y); ctx.scale(scale,scale); ctx.globalAlpha = opacity;
      ctx.rotate(Math.sin(flap)*0.15);
      // body
      ctx.fillStyle = '#d1d5db';
      ctx.beginPath(); ctx.ellipse(0,0,6,4,0,0,Math.PI*2); ctx.fill();
      // wings
      ctx.fillStyle = '#f97316';
      ctx.globalAlpha = opacity * 0.9;
      ctx.beginPath(); ctx.moveTo(0,0);
      ctx.quadraticCurveTo(-18, -6*Math.sin(flap), -32, 0);
      ctx.quadraticCurveTo(-18, 6*Math.sin(flap), 0,0); ctx.fill();
      ctx.beginPath(); ctx.moveTo(0,0);
      ctx.quadraticCurveTo(18, -6*Math.sin(flap), 32, 0);
      ctx.quadraticCurveTo(18, 6*Math.sin(flap), 0,0); ctx.fill();
      ctx.restore();
    }
    function tick(){
      ctx.clearRect(0,0,canvas.width, canvas.height);
      bats.forEach(b=>{
        b.t += 0.1; b.x += b.vx; b.y += Math.sin(b.t)*0.4;
        if(b.x < -40) b.x = canvas.width+40;
        if(b.x > canvas.width+40) b.x = -40;
        drawBat(b.x, b.y, b.s*1.2, b.t, b.opacity);
      });
      requestAnimationFrame(tick);
    }
    tick();

    // ===== Particle system =====
    const particlesContainer = document.getElementById('particles');
    const particles = [];

    class Particle {
      constructor() {
        this.element = document.createElement('div');
        this.element.className = 'particle';
        this.reset();
        particlesContainer.appendChild(this.element);
      }

      reset() {
        this.x = Math.random() * window.innerWidth;
        this.y = window.innerHeight + 10;
        this.size = Math.random() * 4 + 2;
        this.speed = Math.random() * 2 + 1;
        this.element.style.left = this.x + 'px';
        this.element.style.top = this.y + 'px';
        this.element.style.width = this.size + 'px';
        this.element.style.height = this.size + 'px';
      }

      update() {
        this.y -= this.speed;
        this.element.style.top = this.y + 'px';

        if (this.y < -10) {
          this.reset();
        }
      }
    }

    for (let i = 0; i < 50; i++) {
      particles.push(new Particle());
    }

    function animateParticles() {
      particles.forEach(particle => particle.update());
      requestAnimationFrame(animateParticles);
    }
    animateParticles();

    // ===== Interactive click effects =====
    document.addEventListener('click', (e) => {
      // Create sound wave effect
      const wave = document.createElement('div');
      wave.className = 'sound-wave';
      wave.style.left = e.clientX + 'px';
      wave.style.top = e.clientY + 'px';
      document.body.appendChild(wave);
      setTimeout(() => wave.remove(), 1000);

      // Random Halloween sound effect (visual)
      const sounds = ['üëª', 'üéÉ', 'ü¶á', 'üï∑Ô∏è', 'üï∏Ô∏è', 'üíÄ', 'üßô‚Äç‚ôÄÔ∏è'];
      const sound = document.createElement('div');
      sound.textContent = sounds[Math.floor(Math.random() * sounds.length)];
      sound.style.position = 'fixed';
      sound.style.left = e.clientX + 'px';
      sound.style.top = e.clientY + 'px';
      sound.style.fontSize = '2rem';
      sound.style.pointerEvents = 'none';
      sound.style.animation = 'float 1s ease-out';
      sound.style.zIndex = '10';
      document.body.appendChild(sound);
      setTimeout(() => sound.remove(), 1000);
    });

    // ===== Mouse follower effect =====
    const cursor = document.createElement('div');
    cursor.style.position = 'fixed';
    cursor.style.width = '20px';
    cursor.style.height = '20px';
    cursor.style.borderRadius = '50%';
    cursor.style.background = 'radial-gradient(circle, rgba(255,106,0,0.3) 0%, transparent 70%)';
    cursor.style.pointerEvents = 'none';
    cursor.style.zIndex = '9999';
    cursor.style.transition = 'transform 0.1s ease';
    document.body.appendChild(cursor);

    document.addEventListener('mousemove', (e) => {
      cursor.style.left = e.clientX - 10 + 'px';
      cursor.style.top = e.clientY - 10 + 'px';
    });

    // ===== Enhanced button interactions =====
    document.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('mouseenter', () => {
        btn.classList.add('glow-on-hover');
      });
      btn.addEventListener('mouseleave', () => {
        btn.classList.remove('glow-on-hover');
      });
    });

    // ===== Prefill address to link if ?ref given =====
    const qp = new URLSearchParams(location.search);
    const ref = qp.get('ref');
    if(ref && /^0x[a-fA-F0-9]{40}$/.test(ref)){
      addrIn.value = ref;
      document.getElementById('makeLink').click();
    }

    // ===== Spooky random messages =====
    const spookyMessages = document.getElementById('spookyMessages');
    const messages = [
      "üéÉ BOO! Did I scare you? üéÉ",
      "üëª The spirits are watching... üëª",
      "ü¶á Bats in the belfry! ü¶á",
      "üï∑Ô∏è Something wicked this way comes... üï∑Ô∏è",
      "üíÄ The BOO is eternal! üíÄ",
      "üßô‚Äç‚ôÄÔ∏è Magic is in the air... üßô‚Äç‚ôÄÔ∏è",
      "üéÉ Happy Halloween! üéÉ"
    ];

    function showSpookyMessage() {
      const msg = document.createElement('div');
      msg.className = 'spooky-msg';
      msg.textContent = messages[Math.floor(Math.random() * messages.length)];
      msg.style.left = Math.random() * 70 + 15 + '%';
      msg.style.top = Math.random() * 60 + 20 + '%';
      spookyMessages.appendChild(msg);
      setTimeout(() => msg.remove(), 3000);
    }

    // Show random messages every 15-30 seconds
    setInterval(() => {
      if (Math.random() < 0.3) { // 30% chance
        showSpookyMessage();
      }
    }, 15000 + Math.random() * 15000);

    // ===== Logo click effect =====
    const logo = document.querySelector('.logo');
    if (logo) {
      logo.addEventListener('click', () => {
        // Create explosion effect
        for (let i = 0; i < 20; i++) {
          const particle = document.createElement('div');
          particle.textContent = 'üéÉ';
          particle.style.position = 'fixed';
          particle.style.left = '50%';
          particle.style.top = '50%';
          particle.style.fontSize = '2rem';
          particle.style.pointerEvents = 'none';
          particle.style.zIndex = '10';
          particle.style.animation = `explode 1s ease-out ${i * 0.05}s`;
          document.body.appendChild(particle);
          setTimeout(() => particle.remove(), 1000);
        }

        // Add explode animation
        const explodeStyle = document.createElement('style');
        explodeStyle.textContent = `
          @keyframes explode {
            0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
            100% { transform: translate(${Math.random() * 400 - 200}px, ${Math.random() * 400 - 200}px) scale(1) rotate(360deg); opacity: 0; }
          }
        `;
        document.head.appendChild(explodeStyle);
        setTimeout(() => explodeStyle.remove(), 1000);
      });
    }

    // ===== Load ambassadors from JSON =====
    async function loadAmbassadors() {
      try {
        const response = await fetch('./ambassadors.json');
        const ambassadors = await response.json();
        const grid = document.getElementById('ambassadorsGrid');

        ambassadors.forEach(ambassador => {
          const card = document.createElement('div');
          card.className = 'ambassador-card';
          card.innerHTML = `
            <div class="ambassador-avatar">${ambassador.avatar}</div>
            <div class="ambassador-info">
              <div class="ambassador-name">${ambassador.handle}</div>
              <div class="ambassador-tier">${ambassador.tier} - ${ambassador.commission}</div>
              <div class="ambassador-volume">Volume: ${(ambassador.volumeBoo / 1000).toFixed(0)}K $BOO</div>
              <div class="ambassador-actions" style="margin-top:10px; display:flex; gap:5px;">
                <button class="btn copy-btn" onclick="copyToClipboard('${location.origin}/early?ref=${ambassador.wallet}&utm_source=ambassador&utm_medium=link&utm_campaign=presale_oct5')" style="font-size:11px; padding:4px 8px;">Copy Link</button>
                <button class="btn qr-btn" onclick="showQR('${location.origin}/early?ref=${ambassador.wallet}&utm_source=ambassador&utm_medium=link&utm_campaign=presale_oct5')" style="font-size:11px; padding:4px 8px;">QR</button>
              </div>
            </div>
          `;
          grid.appendChild(card);
        });
      } catch (error) {
        console.error('Failed to load ambassadors:', error);
      }
    }

    // ===== QR Code functionality =====
    function showQR(link) {
      // Load QRCode library if not already loaded
      if (typeof QRCode === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js';
        script.onload = () => generateQR(link);
        document.head.appendChild(script);
      } else {
        generateQR(link);
      }
    }

    function generateQR(link) {
      const modal = document.createElement('div');
      modal.style.cssText = `
        position:fixed; inset:0; background:#0008; display:grid; place-items:center;
        z-index:9999; backdrop-filter:blur(5px);
      `;
      modal.innerHTML = `
        <div style="background:#1a1830; padding:20px; border-radius:15px; border:1px solid #ffffff22; text-align:center;">
          <h3 style="margin:0 0 15px 0; color:#ffd700;">Scan QR Code</h3>
          <div id="qrcode"></div>
          <p style="margin:15px 0 0 0; font-size:12px; color:#9aa0aa; word-break:break-all;">${link}</p>
          <button onclick="this.closest('div').parentElement.remove()" style="margin-top:15px; background:#ff6a00; color:white; border:none; padding:8px 16px; border-radius:8px; cursor:pointer;">Close</button>
        </div>
      `;
      document.body.appendChild(modal);

      QRCode.toCanvas(document.getElementById('qrcode'), link, {
        width: 200,
        height: 200,
        color: { dark: '#ffffff', light: '#1a1830' }
      });
    }

    // ===== Copy to clipboard =====
    async function copyToClipboard(text) {
      try {
        await navigator.clipboard.writeText(text);
        showToast('Link copied to clipboard!');
      } catch (err) {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showToast('Link copied to clipboard!');
      }
    }

    // ===== Load ambassadors on page load =====
    loadAmbassadors();

    // ===== Live Contract Data Integration =====
    async function loadLiveData() {
      try {
        // Check if MetaMask or another wallet is available
        if (typeof window.ethereum !== 'undefined') {
          const provider = new ethers.providers.Web3Provider(window.ethereum);

          // Contract addresses
          const tokenAddress = '0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD';
          const feeRouterAddress = '0x992f1e349741b5fA61fc7B0c901ee6e5959793Ca';

          // Minimal ABIs for reading data
          const tokenABI = [
            "function totalSupply() view returns (uint256)",
            "function balanceOf(address) view returns (uint256)",
            "function paused() view returns (bool)"
          ];

          const feeRouterABI = [
            "function totalBurned() view returns (uint256)",
            "function totalFeesCollected() view returns (uint256)"
          ];

          // Connect to contracts
          const tokenContract = new ethers.Contract(tokenAddress, tokenABI, provider);
          const feeRouterContract = new ethers.Contract(feeRouterAddress, feeRouterABI, provider);

          // Read live data
          const totalSupply = await tokenContract.totalSupply();
          const ownerBalance = await tokenContract.balanceOf('0x9Dc918deBA2d3fc7128A59852b6699CCb2dC0EDB');
          const isPaused = await tokenContract.paused();

          let totalBurned = '0';
          let totalFees = '0';
          try {
            totalBurned = await feeRouterContract.totalBurned();
            totalFees = await feeRouterContract.totalFeesCollected();
          } catch (e) {
            // Fee router might not have these functions yet
            console.log('Fee data not available yet');
          }

          // Format numbers
          const formatNumber = (num) => {
            const val = ethers.utils.formatEther(num);
            return parseFloat(val).toLocaleString('en-US', { maximumFractionDigits: 2 });
          };

          // Update UI elements
          const supplyEl = document.getElementById('totalSupply');
          const burnedEl = document.getElementById('totalBurned');
          const feesEl = document.getElementById('totalFees');
          const statusEl = document.getElementById('contractStatus');

          if (supplyEl) supplyEl.textContent = formatNumber(totalSupply) + ' BOO';
          if (burnedEl) burnedEl.textContent = formatNumber(totalBurned) + ' BOO';
          if (feesEl) feesEl.textContent = formatNumber(totalFees) + ' BOO';
          if (statusEl) {
            statusEl.textContent = isPaused ? 'üîí Paused (Pre-Launch)' : 'üöÄ Active';
            statusEl.style.color = isPaused ? 'var(--red)' : 'var(--green)';
          }

          console.log('Live data loaded successfully');
        } else {
          console.log('Web3 provider not available - showing static data');
        }
      } catch (error) {
        console.error('Error loading live data:', error);
      }
    }

    // ===== Enhanced Early Access with Swap Integration =====
    async function initializeEarlyAccess() {
      const buyBtn = document.getElementById('buyEarlyBtn');
      const amountInput = document.getElementById('buyAmount');
      const connectBtn = document.getElementById('connectWalletBtn');

      if (!buyBtn || !connectBtn) return;

      let signer = null;
      let provider = null;

      // Connect wallet function
      connectBtn.addEventListener('click', async () => {
        try {
          if (typeof window.ethereum === 'undefined') {
            showToast('Please install MetaMask or another Web3 wallet');
            return;
          }

          await window.ethereum.request({ method: 'eth_requestAccounts' });
          provider = new ethers.providers.Web3Provider(window.ethereum);
          signer = provider.getSigner();

          const address = await signer.getAddress();
          connectBtn.textContent = `${address.slice(0, 6)}...${address.slice(-4)}`;
          connectBtn.style.background = 'var(--green)';
          showToast('Wallet connected successfully!');

          // Enable buy button
          buyBtn.disabled = false;
          buyBtn.textContent = 'Buy Early Access';

        } catch (error) {
          console.error('Wallet connection failed:', error);
          showToast('Failed to connect wallet');
        }
      });

      // Buy function
      buyBtn.addEventListener('click', async () => {
        if (!signer) {
          showToast('Please connect your wallet first');
          return;
        }

        const amount = parseFloat(amountInput?.value || '100');
        if (amount < 100) {
          showToast('Minimum purchase: 100 BOO');
          return;
        }

        try {
          buyBtn.disabled = true;
          buyBtn.textContent = 'Processing...';

          // For now, show a message about early access
          // In production, this would integrate with a DEX or direct purchase contract
          showToast(`Early access purchase for ${amount} BOO - Coming soon! Contract is live but purchase flow needs DEX integration.`);

          // Reset button
          setTimeout(() => {
            buyBtn.disabled = false;
            buyBtn.textContent = 'Buy Early Access';
          }, 2000);

        } catch (error) {
          console.error('Purchase failed:', error);
          showToast('Purchase failed - please try again');
          buyBtn.disabled = false;
          buyBtn.textContent = 'Buy Early Access';
        }
      });
    }

    // Year
    document.getElementById('yr').textContent = new Date().getFullYear();

    // ===== ENHANCED SWAP FUNCTIONALITY =====
    const USDC = "0x3c499c542cEF5E3811e1192ce70d8cC03d5c3359";
    const BOO = "0x550f4AF6E9466E4860c1E26509Df72EC30CF72AD";
    const REF_REGISTRY = "0xbeeE2b44Fa90F2E0A1c9240Fd5483292b2c52fbe";

    async function ensureWallet() {
      if (!window.ethereum) throw new Error("No wallet found - install MetaMask");
      const [addr] = await ethereum.request({ method: "eth_requestAccounts" });
      const chainId = await ethereum.request({ method: "eth_chainId" });
      if (chainId !== "0x89") {
        await ethereum.request({
          method: "wallet_switchEthereumChain",
          params: [{ chainId: "0x89" }]
        });
      }
      return addr;
    }

    async function executeSwap() {
      const msg = (t) => document.getElementById('swapMsg').textContent = t;
      const btn = document.getElementById('swapBtn');
      const originalText = btn.textContent;

      try {
        btn.textContent = 'Connecting...';
        btn.disabled = true;

        const from = await ensureWallet();
        const usdc = document.getElementById('swapAmount').value;

        if (!usdc || Number(usdc) < 1) throw new Error("Enter USDC amount (>=1)");

        msg('Finding best route...');
        const sellAmount = BigInt(Math.floor(Number(usdc) * 1e6)).toString();
        const qs = new URLSearchParams({
          buyToken: BOO,
          sellToken: USDC,
          sellAmount,
          takerAddress: from
        });

        const r = await fetch(`https://polygon.api.0x.org/swap/v1/quote?${qs}`);
        if (!r.ok) {
          const e = await r.text();
          throw new Error(e.slice(0, 200));
        }

        const q = await r.json();
        msg(`Route: ~${(Number(q.buyAmount) / 1e18).toFixed(0)} BOO`);

        // Check and approve allowance if needed
        if (q.allowanceTarget) {
          const allowance = await ethereum.request({
            method: "eth_call",
            params: [{
              to: USDC,
              data: "0xdd62ed3e" + from.slice(2).padStart(64, '0') + q.allowanceTarget.slice(2).padStart(64, '0')
            }, "latest"]
          });

          if (BigInt(allowance) < BigInt(sellAmount)) {
            msg('Approving USDC...');
            await ethereum.request({
              method: "eth_sendTransaction",
              params: [{
                from,
                to: USDC,
                data: "0x095ea7b3" + q.allowanceTarget.slice(2).padStart(64, '0') + (2n**256n-1n).toString(16).padStart(64, '0')
              }]
            });
          }
        }

        // Execute swap
        msg('Executing swap...');
        btn.textContent = 'Swapping...';
        await ethereum.request({
          method: "eth_sendTransaction",
          params: [{
            from,
            to: q.to,
            data: q.data,
            value: q.value || "0x0"
          }]
        });

        msg("‚úÖ Swap sent! Check wallet for $BOO");
        showToast("Swap successful! Welcome to the BOO army! üéÉ");

      } catch (e) {
        msg("‚ùå Swap failed: " + (e.message || e));
        console.error('Swap error:', e);
      } finally {
        btn.textContent = originalText;
        btn.disabled = false;
      }
    }

    // ===== REFERRAL DASHBOARD FUNCTIONALITY =====
    const refAbi = [
      "event AffiliateCommission(address indexed referrer, uint256 volumeAfter, uint256 bpsApplied, uint256 commission)",
      "function rollingRefVolume(address referrer, uint256 lookback) view returns (uint256)"
    ];

    async function loadReferralStats(addr) {
      const out = (html) => {
        document.getElementById('refStatsContainer').style.display = 'block';
        document.getElementById('refVolume').textContent = html.volume || '0';
        document.getElementById('refTier').textContent = html.tier || 'Base';
        document.getElementById('refBps').textContent = html.bps || '1.5% commission';
        document.getElementById('refNextTarget').textContent = html.next || '1,000';
        document.getElementById('refLink').textContent = html.link || 'Loading...';
      };

      try {
        const provider = new ethers.providers.JsonRpcProvider("https://polygon-rpc.com");
        let vol30 = 0n;

        try {
          // Try on-chain view first
          const reg = new ethers.Contract(REF_REGISTRY, refAbi, provider);
          vol30 = await reg.rollingRefVolume(addr, 30n * 24n * 3600n);
        } catch {
          // Fallback: scan recent events (~30 days)
          const latest = await provider.getBlockNumber();
          const blocks30d = Math.floor((30 * 24 * 3600) / 2);
          const fromBlock = Math.max(0, latest - blocks30d);

          const topic = ethers.utils.id("AffiliateCommission(address,uint256,uint256,uint256)");
          const logs = await provider.getLogs({
            address: REF_REGISTRY,
            fromBlock,
            toBlock: "latest",
            topics: [topic, ethers.utils.hexZeroPad(addr, 32)]
          });

          for (const l of logs) {
            const parsed = ethers.utils.defaultAbiCoder.decode(["uint256", "uint256", "uint256"], "0x" + l.data.slice(2));
            vol30 = parsed[0]; // volumeAfter (latest cumulative)
          }
        }

        const vol = Number(vol30) / 1e18;
        let tier = { name: "Base", bps: 150, next: 1000 - Math.min(vol, 1000) };

        if (vol >= 100000) tier = { name: "Tier 1", bps: 300, next: 0 };
        else if (vol >= 25000) tier = { name: "Tier 2", bps: 250, next: 100000 - vol };
        else if (vol >= 1000) tier = { name: "Tier 3", bps: 200, next: 25000 - vol };

        const refLink = `${location.origin}/early?ref=${addr}`;

        out({
          volume: vol.toLocaleString(),
          tier: tier.name,
          bps: `${(tier.bps / 100).toFixed(2)}% commission`,
          next: Math.max(0, Math.ceil(tier.next)).toLocaleString(),
          link: refLink
        });

        // Set up link tools
        document.getElementById('copyLinkBtn').onclick = () => {
          navigator.clipboard.writeText(refLink);
          showToast("Link copied! üìã");
        };

        document.getElementById('qrCodeBtn').onclick = () => showQR(refLink);

        document.getElementById('tweetBtn').onclick = () => {
          const text = `Join the $BOO Halloween revolution! üéÉ\n\nEarn while you refer friends to the spookiest meme token on Polygon.\n\n‚ú® 0.5% fees, 20% burn, staking rewards\n‚ú® Tiered affiliates up to 3%\n\nGet in early:`;
          window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(refLink)}`);
        };

      } catch (error) {
        console.error('Referral stats error:', error);
        document.getElementById('refVolume').textContent = 'Error';
        document.getElementById('refTier').textContent = 'N/A';
        document.getElementById('refBps').textContent = 'Unable to load';
      }
    }

    // ===== EVENT LISTENERS =====
    function initializeSwapAndReferral() {
      // Swap functionality
      const swapBtn = document.getElementById('swapBtn');
      if (swapBtn) {
        swapBtn.addEventListener('click', executeSwap);
      }

      // Referral dashboard
      const refConnectBtn = document.getElementById('refConnectBtn');
      if (refConnectBtn) {
        refConnectBtn.addEventListener('click', async () => {
          try {
            refConnectBtn.textContent = 'Connecting...';
            refConnectBtn.disabled = true;
            const addr = await ensureWallet();
            refConnectBtn.textContent = `Connected: ${addr.slice(0, 6)}...${addr.slice(-4)}`;
            loadReferralStats(addr);
          } catch (error) {
            refConnectBtn.textContent = 'Connect Wallet to Load Stats';
            refConnectBtn.disabled = false;
            showToast('Connection failed: ' + error.message);
          }
        });
      }
    }

    // ===== Load ethers.js and initialize Web3 =====
    const script = document.createElement('script');
    script.src = 'https://cdn.ethers.org/lib/ethers-5.2.umd.min.js';
    script.onload = function() {
      console.log('ethers.js loaded successfully');
      loadLiveData();
      initializeEarlyAccess();
      initializeSwapAndReferral();
    };
    script.onerror = function() {
      console.error('Failed to load ethers.js');
    };
    document.head.appendChild(script);
  </script>
</body>
</html>